<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" vocab="http://ogp.me/ns" lang="en">
<head>
<link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<!-- Enable responsiveness on mobile devices--><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta name="description" content="None">
<meta name="author" content="punchagan">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
<link href="/assets/css/all.css" rel="stylesheet" type="text/css">
<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]--><link rel="alternate" type="application/rss+xml" title="RSS for tag blag (en)" href="/tags/blag.xml">
<link rel="stylesheet" type="text/css" href="/assets/css/tipuesearch.css">
<title>
      Posts about blag (old posts, page 1) · Noetic Nought
  </title>
</head>
<body class="layout-reverse sidebar-overlay theme-base-0d">

<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox" checked><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">

  <nav class="sidebar-nav"><!-- The code below dynamically generates a sidebar nav of pages with --><!-- `layout: page` in the front-matter. See readme for usage. --><a class="sidebar-nav-item" href="/index.html" title="Home">
          <i class="fa fa-home on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/index.html">Home</span>
      <a class="sidebar-nav-item" href="/posts/index.html" title="Blog">
          <i class="fa fa-pencil on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/posts/index.html">Blog</span>
      <a class="sidebar-nav-item" href="/archive.html" title="Archives">
          <i class="fa fa-archive on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/archive.html">Archives</span>
      <a class="sidebar-nav-item" href="/tags/index.html" title="Tags">
          <i class="fa fa-tags on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/tags/index.html">Tags</span>
      <a class="sidebar-nav-item" href="/projects/" title="Projects">
          <i class="fa fa-cogs on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/projects/">Projects</span>
      <a class="sidebar-nav-item" href="/tags/cat_recursecenter-checkins.html" title="Recurse Center Logs">
          <i class="fa fa-magic on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/tags/cat_recursecenter-checkins.html">Recurse Center Logs</span>
      <a class="sidebar-nav-item" href="/tags/cat_bookmarks.html" title="Bookmarks">
          <i class="fa fa-bookmark on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/tags/cat_bookmarks.html">Bookmarks</span>
      <a class="sidebar-nav-item" href="/quotes.html" title="Quotes">
          <i class="fa fa-quote-right on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/quotes.html">Quotes</span>
      <a class="sidebar-nav-item" href="/reading-list.html" title="Reading List">
          <i class="fa fa-book on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/reading-list.html">Reading List</span>
      <a class="sidebar-nav-item" href="/rss.xml" title="RSS">
          <i class="fa fa-rss on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="/rss.xml">RSS</span>
      <a class="sidebar-nav-item" href="https://github.com/punchagan" title="GitHub">
          <i class="fa fa-github on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="https://github.com/punchagan">GitHub</span>
      <a class="sidebar-nav-item" href="https://twitter.com/punchagan" title="Twitter">
          <i class="fa fa-twitter on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="https://twitter.com/punchagan">Twitter</span>
      <a class="sidebar-nav-item" href="mailto:punchagan+blog@muse-amuse.in" title="Email">
          <i class="fa fa-at on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="mailto:punchagan+blog@muse-amuse.in">Email</span>
      <a class="sidebar-nav-item" href="http://creativecommons.org/licenses/by-sa/4.0/" title="CC-BY">
          <i class="fa fa-creative-commons on fa-lg"></i>
      </a>
      <span class="sidebar-nav-item-title" href="http://creativecommons.org/licenses/by-sa/4.0/">CC-BY</span>

  </nav>
</div>
    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Noetic Nought</a>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="post-title p-name entry-title"><a href="/posts/partial-postgres-db-dumps-for-a-django-app.html" class="u-url">Partial postgres db dumps for a Django app</a></h1>
        <span class="post-date">10 Jan 2016</span>
    </header><div class="e-content entry-content">
    <p>
Off late, I have been working with a large <code>postgres</code> database that is used by
an app built in <code>Django</code>.  I wanted a partial dump of the database to try out
some experimental clean up scripts.  I haven't really used databases before,
and the last time I had to do this I did it in a pretty ad-hoc fashion.  This
time around, I tried to do it more methodically and to document it.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">The Django Route</h2>
<div class="outline-text-2" id="text-1">
<p>
I looked around for tools that let you do this, and found <a href="https://github.com/davedash/django-fixture-magic">django-fixture-magic</a>.
I first tried it out on my older partial dump (10% as large as the original db)
and it turned out to be reasonably fast and worked well, after making a <a href="https://github.com/davedash/django-fixture-magic/pull/35">few
changes</a> to get it working with Python 3.x.  Its <code>kitchensink</code> flag to the
<code>dump_object</code> seemed like a promising option, but <b>didn't</b> really seem to get all
the required tables for ManyToManyFields.  I worked around it, by getting a
dump of all the models which were related using Django's <code>dumpdata</code>.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Get a dump with objects of interest</h3>
<div class="outline-text-3" id="text-1-1">
<p>
The <code>dump_object</code> command lets you run commands to select the objects that you
want to have in the dump, and that is quite a useful thing.
</p>

<div class="highlight"><pre>python manage.py dump_object dataset.Product -k --query <span class="s1">'{"subcategory_id__in": [1886, ...]}'</span> &gt; products.json
</pre></div>

<p>
Also, get a dump of related tables.
</p>

<div class="highlight"><pre><span class="c"># Dump of related fields</span>
python manage.py dumpdata dataset.Attribute &gt; attributes.json
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Create the new empty db</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Next, create a new database where this fixture can be loaded!
</p>

<div class="highlight"><pre><span class="c"># Create the db</span>
sudo su - postgres
createdb mydb

<span class="c"># Create a user, if required</span>
createuser -P
</pre></div>
</div>

<div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1">Grant access to the user</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
In the <code>psql</code> prompt type the following to grant the user permissions for the
database.
</p>

<div class="highlight"><pre><span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">mydb</span> <span class="k">TO</span> <span class="n">myuser</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Fix settings.py and create tables for the models.</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Make changes to <code>settings.py</code> to use the newly created database, and then
create the tables used by the app, and then load the data.
</p>

<div class="highlight"><pre>python manage.py syncdb
python manage.py loaddata products.json
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">Too slow!</h3>
<div class="outline-text-3" id="text-1-4">
<p>
This method worked and was reasonably fast when I was trying to get 20k rows
from a table with about 200k rows, with all the dependencies.
</p>

<p>
But, when I tried to get a dump of about 200k rows from a table with 2M rows,
it was way too slow to be of any use.  There could've been a couple of reasons
for this, which I didn't have the time to look into, and debug.
</p>

<ul class="org-ul">
<li>The web-server where the <code>Django</code> app was running, and the <code>db</code> server with
the <code>postgres</code> database were on different machines in separate datacenters,
which could've been adding a significant amount of latency.
</li>

<li>Just the size of the database being much larger could be making it slower?
</li>
</ul>
<p>
These are things I should be looking into and learning about, when I have more
time at hand.  For now, I needed a quicker way to get a dump.  Even though the
raw SQL route was more manual, it turned out to be much quicker.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Raw SQL dump route</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Get a dump of the interesting tables</h3>
<div class="outline-text-3" id="text-2-1">
<p>
First, I had to get a dump of all the tables with the data I was interested in,
one-by-one.
</p>

<div class="highlight"><pre><span class="k">COPY</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="ss">"dataset_product"</span> <span class="k">WHERE</span> <span class="p">(</span><span class="ss">"dataset_product"</span><span class="p">.</span><span class="ss">"subcategory_id"</span> <span class="k">IN</span> <span class="p">(</span><span class="mi">319557</span><span class="p">,</span> <span class="mi">94589</span><span class="p">,</span> <span class="mi">332</span><span class="p">,</span> <span class="mi">406</span><span class="p">,</span> <span class="mi">626</span><span class="p">,</span> <span class="mi">1886</span><span class="p">)</span> <span class="k">AND</span> <span class="ss">"dataset_product"</span><span class="p">.</span><span class="ss">"gender_id"</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span> <span class="k">TO</span> <span class="s1">'/tmp/products.tsv'</span>

<span class="k">COPY</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="ss">"dataset_photo"</span> <span class="k">WHERE</span> <span class="ss">"dataset_photo"</span><span class="p">.</span><span class="ss">"product_id"</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">U0</span><span class="p">.</span><span class="ss">"id"</span> <span class="k">FROM</span> <span class="ss">"dataset_product"</span> <span class="n">U0</span> <span class="k">WHERE</span> <span class="p">(</span><span class="n">U0</span><span class="p">.</span><span class="ss">"subcategory_id"</span> <span class="k">IN</span> <span class="p">(</span><span class="mi">319557</span><span class="p">,</span> <span class="mi">94589</span><span class="p">,</span> <span class="mi">332</span><span class="p">,</span> <span class="mi">406</span><span class="p">,</span> <span class="mi">626</span><span class="p">,</span> <span class="mi">1886</span><span class="p">)</span> <span class="k">AND</span> <span class="n">U0</span><span class="p">.</span><span class="ss">"gender_id"</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)))</span> <span class="k">TO</span> <span class="s1">'/tmp/photos.tsv'</span>

<span class="c1">-- Copy a bunch of other tables!</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Load the data from the dumps</h3>
<div class="outline-text-3" id="text-2-2">
<div class="highlight"><pre><span class="c1">-- syncdb</span>
<span class="k">COPY</span> <span class="n">dataset_product</span> <span class="k">FROM</span> <span class="s1">'/tmp/products.tsv'</span> <span class="k">ENCODING</span> <span class="s1">'UTF8'</span><span class="p">;</span>
<span class="k">COPY</span> <span class="n">dataset_photo</span> <span class="k">FROM</span> <span class="s1">'/tmp/photos.tsv'</span> <span class="k">ENCODING</span> <span class="s1">'UTF8'</span><span class="p">;</span>
<span class="c1">-- Copy a bunch of other tables!</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Make tables writable</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Some of the tables did not let me write anything to them, until I <a href="http://centoshowtos.org/web-services/django-and-postgres-duplicate-key/">altered the
sequence</a> for these tables.
</p>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">Automating</h3>
<div class="outline-text-3" id="text-2-4">
<p>
It would be pretty nice if all of this was automated – allow a user to enter
exactly the same kind of a query that <code>django-fixture-magic</code> lets you run, and
figure out the SQL copies that need to be done to get the requested dump. Its
something that currently would qualify as yak-shaving, but may be a handy thing
to have. Someone somewhere possibly already has something that does this.
</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="post-title p-name entry-title"><a href="/posts/clock-in-and-get-shit-done.html" class="u-url">Clock in and get-shit-done</a></h1>
        <span class="post-date">22 Dec 2015</span>
    </header><div class="e-content entry-content">
    <p>
I had <a href="/posts/simple-org-clock-and-gnomepidgin-integration.html">setup</a> a couple of hooks about an year ago that turn off all notifications
while I'm clocking in. But, I find myself switching to the browser and jumping
to twitter, out of habit.  I've tried <a href="https://github.com/leftnode/get-shit-done">get-shit-done</a> in the past to help myself
break this habit. But enabling get-shit-done manually is step that quickly
became a non-habit.
</p>

<p>
So, I hooked up get-shit-done into an <code>org-clock-in-hook</code>.  The snippet below
is what I added into a function that is added to this hook.
</p>

<div class="highlight"><pre><span class="p">(</span><span class="nv">with-temp-buffer</span>
  <span class="p">(</span><span class="nv">cd</span> <span class="s">"/sudo::/"</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">shell-command</span> <span class="s">"HOME=/home/punchagan get-shit-done work"</span><span class="p">))</span>
</pre></div>

<p>
<code>get-shit-done</code> needs to be run as <code>root</code>, since it does things like modifying
<code>/etc/hosts</code> and restarting networking.  Just calling <code>get-shit-done</code> as a
shell command fails with the error <code>sudo: no tty present and no askpass program
specified</code>.  I found a couple of ways to fix this. The snippet above
piggy-backs on tramp to allow for a way to enter the password for <code>sudo</code> to
use. This also means that I don't need to enter the password, as long as the
tramp connection is alive.
</p>

<p>
For someone worried about having such an easy way of running something as
<code>root</code>, using something like <code>gnome-ssh-askpass</code> as the askpass program might
work better.
</p>

<div class="highlight"><pre><span class="p">(</span><span class="nv">shell-command</span> <span class="s">"SUDO_ASKPASS=\"/usr/lib/openssh/gnome-ssh-askpass\" get-shit-done work"</span><span class="p">)</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="post-title p-name entry-title"><a href="/posts/elfeed-hook-to-fetch-full-content.html" class="u-url">Elfeed hook to fetch full content</a></h1>
        <span class="post-date">19 Dec 2015</span>
    </header><div class="e-content entry-content">
    <p>
I have started to use <a href="http://pinboard.in">Pinboard</a>'s <code>unread</code> tag as my to-read list.  It has a
bookmark-let that works pretty well for adding stuff into my "to-read" list.  I
then catch up on this list using <code>elfeed</code> and subscribing to the unread items'
RSS feed.  The work-flow is pretty nice for adding stuff into the list, and
finding items on the list. But, when it comes to the actual reading part, the
entries in the feed don't have the actual content I want to read, and I end up
opening the links in a browser.
</p>

<p>
Inspired by a <a href="https://github.com/sursh/blaggregator/pull/80#issuecomment-165849126">comment from FiloSottile</a>, I realized it should be pretty easy to
setup a hook that fetches the actual content to make my reading work-flow
smoother. I wrote a <a href="https://github.com/punchagan/dot-files/blob/master/bin/get_article.py">small script</a>, using <a href="https://github.com/buriy/python-readability">python-readability</a>, to fetch the page
content, given a URL. This script is then hooked onto <code>elfeed-new-entry-hook</code>,
to fetch content of for new entries as they are fetched.  All the old entries
can be easily fixed with a single call to <code>elfeed-apply-hooks-now</code>.
</p>

<div class="highlight"><pre><span class="p">(</span><span class="nb">defun</span> <span class="nv">pc/get-url-content</span> <span class="p">(</span><span class="nv">url</span><span class="p">)</span>
  <span class="s">"Fetches the content for a url."</span>
  <span class="p">(</span><span class="nv">shell-command-to-string</span> <span class="p">(</span><span class="nb">format</span> <span class="s">"~/bin/get_article.py %s"</span> <span class="nv">url</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">pc/get-entry-content</span> <span class="p">(</span><span class="nv">entry</span><span class="p">)</span>
  <span class="s">"Fetches content for pinboard entries that are not tweets."</span>
  <span class="p">(</span><span class="nv">interactive</span>
   <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">entry</span> <span class="nv">elfeed-show-entry</span><span class="p">))</span>
     <span class="p">(</span><span class="nb">list</span> <span class="nv">entry</span><span class="p">)))</span>

  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">url</span> <span class="p">(</span><span class="nv">elfeed-entry-link</span> <span class="nv">entry</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">feed-id</span> <span class="p">(</span><span class="nv">elfeed-deref</span> <span class="p">(</span><span class="nv">elfeed-entry-feed-id</span> <span class="nv">entry</span><span class="p">)))</span>
	<span class="p">(</span><span class="nv">content</span> <span class="p">(</span><span class="nv">elfeed-deref</span> <span class="p">(</span><span class="nv">elfeed-entry-content</span> <span class="nv">entry</span><span class="p">))))</span>
    <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">s-matches?</span> <span class="s">"feeds.pinboard.in/"</span> <span class="nv">feed-id</span><span class="p">)</span>
	       <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nv">s-matches?</span> <span class="s">"twitter.com/\\|pdf$\\|png$\\|jpg$"</span> <span class="nv">url</span><span class="p">))</span>
	       <span class="p">(</span><span class="nb">string-equal</span> <span class="s">""</span> <span class="nv">content</span><span class="p">))</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">content</span> <span class="p">(</span><span class="nv">pc/get-url-content</span> <span class="nv">url</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">setf</span> <span class="p">(</span><span class="nv">elfeed-entry-content</span> <span class="nv">entry</span><span class="p">)</span> <span class="p">(</span><span class="nv">elfeed-ref</span> <span class="nv">content</span><span class="p">)))))</span>

<span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'elfeed-new-entry-hook</span> <span class="nf">#'</span><span class="nv">pc/get-entry-content</span><span class="p">)</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="post-title p-name entry-title"><a href="/posts/say-howdy-with-emacs.html" class="u-url">Say Howdy with Emacs!</a></h1>
        <span class="post-date">28 May 2015</span>
    </header><div class="e-content entry-content">
    <p>
Staying in touch with people is something I'm not very good at.  Since I am not
on popular (among my friends/family) networks – FB and Whatsapp – I don't
even see random updates from people, to get some sense of being in touch.
</p>

<p>
I recently read some old posts by Sacha Chua and was inspired by how much code
she had for <a href="http://sachachua.com/blog/category/geek/emacs/bbdb/">contact management</a> in her old blog posts.  I was inspired by <a href="http://sachachua.com/blog/2005/05/keeping-in-touch/">this
post</a> in particular to try and be more meticulous about how I stay in touch with
people. Michael Fogleman <a href="https://mwfogleman.github.io/posts/08-01-2015-emacs-can-keep-in-touch.html">blogged</a> about his contact management work-flow using
<code>keepintouch</code>. It seemed to do most of what I wanted, but I wanted this to be
integrated with my <code>org-contacts-db</code> and I felt having native elisp code would
make it easier to hook up email, chat, etc. to this.
</p>

<p>
I ended up writing a small utility called <a href="https://github.com/punchagan/howdy/">howdy</a> to help me keep in touch with
people. It currently has only a couple of features:
</p>

<ul class="org-ul">
<li>
<code>M-x howdy</code> lets me update the last contacted timestamp for a contact.
</li>
<li>Shows me contacts that I'm out of touch in the agenda, once I add the
following snippet to an agenda file.
<div class="highlight"><pre>* Howdy
  %%(howdy-howdy)
</pre></div>
</li>
</ul>
<p>
I also have a few hooks to hook up jabber messages and email to update the db.
I've added them to <code>howdy-hooks.el</code> in case anybody else wants to use them.
They can also be used as examples to write other hooks. Feel free to contribute
other hooks or suggest improvements.  The library also ships with a modest test
suite, that will hopefully make it easier for others to contribute.
</p>

<p>
I'm looking forward to experimenting with this over the next few weeks and
improving it. Hopefully, it'll help me keep in touch, better than I do now.
</p>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="post-title p-name entry-title"><a href="/posts/wifi-channels-my-routers-random-invisibility.html" class="u-url">WiFi Channels &amp; my router's random invisibility</a></h1>
        <span class="post-date">22 Apr 2015</span>
    </header><div class="e-content entry-content">
    <p>
To update some data plan changes, I had to restart my router today.  I did so
from the (web) admin interface, from my dad's laptop. Guess what!  The router
goes invisible (to the laptop), after the restart!  Other devices were still
happily connected.
</p>

<p>
There were a few occasions in the past when this laptop had failed to find our
home router.  The solution that worked for my dad before was to restart the
router; once, or may be a couple of times.  But, this time it didn't work.
</p>

<p>
I had a feeling this was something to do with "Channels", but I had no idea
what was going on.
</p>

<p>
I logged onto the router and started looking at the Wireless settings in the
hope of finding some clue, and there it was! <code>Wireless Channel: Auto Scan</code>
</p>


<div class="figure">
<p><img src="/images/auto-scan.jpg" alt="auto-scan.jpg"></p>
</div>

<p>
It was anybody's guess that some channels that the router uses weren't
supported by my dad's laptop.  The restarts <b>sometimes</b> helped because the
router would scan for channels that it thinks would work well, and end-up using
something that the laptop's wifi card supported.
</p>

<p>
The router only had options of channels from 1 to 13.  To see what channels a
wifi card supports, you can run the <code>iwlist freq</code> command.
</p>

<div class="highlight"><pre>iwlist freq
</pre></div>

<div class="highlight"><pre>eth1      26 channels in total; available frequencies :
	  Channel 01 : 2.412 GHz
	  Channel 02 : 2.417 GHz
	  Channel 03 : 2.422 GHz
	  Channel 04 : 2.427 GHz
	  Channel 05 : 2.432 GHz
	  Channel 06 : 2.437 GHz
	  Channel 07 : 2.442 GHz
	  Channel 08 : 2.447 GHz
	  Channel 09 : 2.452 GHz
	  Channel 10 : 2.457 GHz
	  Channel 11 : 2.462 GHz
	  Channel 12 : 2.467 GHz
	  Channel 13 : 2.472 GHz
	  Channel 14 : 2.484 GHz
	  Channel 36 : 5.18 GHz
	  Channel 38 : 5.19 GHz
	  Channel 40 : 5.2 GHz
	  Channel 42 : 5.21 GHz
	  Channel 44 : 5.22 GHz
	  Channel 46 : 5.23 GHz
	  Channel 48 : 5.24 GHz
	  Channel 149 : 5.745 GHz
	  Channel 153 : 5.765 GHz
	  Channel 157 : 5.785 GHz
	  Channel 161 : 5.805 GHz
	  Channel 165 : 5.825 GHz
</pre></div>

<p>
So, the laptop's wifi card support all the channels that the router could use.
<code>iwlist freq</code> also gives the current Channel if the device is already connected
to a router.  I ran this on my laptop and found that the router was using
<code>Channel 13</code>.  Why the hell wouldn't this work?!  I don't know!
</p>

<p>
I decided to set a channel manually, but how do I pick a channel?  The idea of
"Auto Scan" is to find a channel that has relatively low interference.  How do
we do this manually?  <code>sudo iwlist scan</code> scans for all the WiFi access points
nearby and gives detailed information about them, which includes the Channel.
</p>

<p>
It looked like most of the routers nearby used channels 1 and 6, with a few 3s
and 4s.  Assuming, most of the other routers aren't doing this "Auto Scan"
business, I set my router to always use Channel 9, and the laptop seems to be
happily connected, now!
</p>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="post-title p-name entry-title"><a href="/posts/playing-music-using-mpsyt-from-emacs.html" class="u-url">Playing music using mpsyt from Emacs</a></h1>
        <span class="post-date">20 Apr 2015</span>
    </header><div class="e-content entry-content">
    <p>
I've started using the wonderful <a href="https://github.com/np1/mps-youtube/">mpsyt</a> to play any music from youtube, since
I'm not really interested in the video.  But, since I use emacs for chat/IRC, I
end up getting youtube links into emacs and opening them opens them up in my
browser. I ended up writing some <code>elisp</code> to play the songs from within an
instance of <code>mpsyt</code> running inside an emacs buffer.
</p>

<div class="highlight"><pre><span class="p">(</span><span class="nb">defun</span> <span class="nv">pc/short-url-at-point</span> <span class="p">()</span>
  <span class="s">"Gets the short url at point.</span>

<span class="s">This function is required only because</span>
<span class="s">`thing-at-point-url-at-point' ignores urls (without a scheme)</span>
<span class="s">that don't start with www."</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">bounds</span> <span class="p">(</span><span class="nv">thing-at-point-bounds-of-url-at-point</span> <span class="no">t</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">and</span> <span class="nv">bounds</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">bounds</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">bounds</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">buffer-substring-no-properties</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">bounds</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">bounds</span><span class="p">)))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">pc/mpsyt-url</span> <span class="p">(</span><span class="nv">url</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">buffer</span> <span class="p">(</span><span class="nv">current-buffer</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">mpsyt-proc-name</span> <span class="s">"*mpsyt*"</span><span class="p">))</span>

    <span class="c1">;; Start a new term with *mpsyt* if there isn't one</span>
    <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">get-process</span> <span class="nv">mpsyt-proc-name</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">get-buffer</span> <span class="nv">mpsyt-proc-name</span><span class="p">)</span>
	<span class="p">(</span><span class="nv">kill-buffer</span> <span class="p">(</span><span class="nv">get-buffer</span> <span class="nv">mpsyt-proc-name</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">ansi-term</span> <span class="s">"mpsyt"</span> <span class="s">"mpsyt"</span><span class="p">))</span>

    <span class="c1">;; Play given url in mpsyt</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">mpsyt-proc</span> <span class="p">(</span><span class="nv">get-process</span> <span class="nv">mpsyt-proc-name</span><span class="p">)))</span>
      <span class="c1">;; If something is already playing, stop it and play this...</span>
      <span class="p">(</span><span class="nv">term-send-string</span> <span class="nv">mpsyt-proc</span> <span class="s">"\n\n\n"</span><span class="p">)</span>
      <span class="c1">;; We wait for a bit, since looking for the prompt seems to fail, sometimes?</span>
      <span class="p">(</span><span class="nv">sleep-for</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">term-send-string</span> <span class="nv">mpsyt-proc</span> <span class="s">"\n"</span><span class="p">)</span>

      <span class="c1">;; Actually send the command to playurl</span>
      <span class="p">(</span><span class="nv">term-simple-send</span> <span class="p">(</span><span class="nv">get-process</span> <span class="nv">mpsyt-proc-name</span><span class="p">)</span>
			<span class="p">(</span><span class="nb">format</span> <span class="s">"playurl %s"</span> <span class="nv">url</span><span class="p">)))</span>

    <span class="p">(</span><span class="nv">switch-to-buffer</span> <span class="nv">buffer</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">pc/mpsyt-url-at-point</span> <span class="p">()</span>
  <span class="s">"Play the URL at point using mpsyt."</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">url</span> <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nv">url-get-url-at-point</span><span class="p">)</span> <span class="p">(</span><span class="nv">pc/short-url-at-point</span><span class="p">))))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="nv">url</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">message</span> <span class="s">"No URL found"</span><span class="p">)</span>
	<span class="p">(</span><span class="nv">message</span> <span class="p">(</span><span class="nb">format</span> <span class="s">"Playing %s with mpsyt"</span> <span class="nv">url</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">pc/mpsyt-url</span> <span class="nv">url</span><span class="p">))))</span>
</pre></div>

<p>
The current version of mpsyt crashes when run from inside emacs due to a bug in
the code to get the terminal size, which should be fixed once this <a href="https://github.com/np1/mps-youtube/pull/247">patch</a> is
merged.
</p>

<p>
I would've expected <code>thing-at-point-url-at-point</code> to be able to find urls even
when they don't have a schema, but it tries to guess the schema from urls and
fails to work when the url starts with <code>youtube.com</code> instead of
<code>www.youtube.com</code>.
</p>

<p>
I started off using the command-line interface of <code>mpsyt</code> by running it using
<code>shell-command</code> or <code>start-process</code>.  But, it seemed useful to have a buffer of
<code>mpsyt</code> to switch to – easier to search for new music, repeating songs, etc.
Not all tasks/actions are achievable through <code>mpsyt</code>'s command line args.
</p>

<p>
I ended up writing more code than I thought I would have to<sup><a id="fnr.1" name="fnr.1" class="footref" href="/posts/playing-music-using-mpsyt-from-emacs.html#fn.1">1</a></sup>.  But, I'm
pretty happy with how this all works, right now.
</p>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef">
<sup><a id="fn.1" name="fn.1" class="footnum" href="/posts/playing-music-using-mpsyt-from-emacs.html#fnr.1">1</a></sup><p class="footpara">
- Isn't it true, more often than not?
</p>
</div>


</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="post-title p-name entry-title"><a href="/posts/org-drill-for-making-it-stick.html" class="u-url">org-drill for making it stick!</a></h1>
        <span class="post-date">17 Jan 2015</span>
    </header><div class="e-content entry-content">
    <p>
Those who read the <a href="https://punchagan.muse-amuse.in/posts/learning-to-use-org-drill.html">last</a> <a href="https://punchagan.muse-amuse.in/posts/learning-about-spaced-repetition-supermemo-org-drill-et-al.html">few</a> <a href="https://punchagan.muse-amuse.in/posts/more-input-sources-for-org-drill.html">posts</a> here, would know that I have been
experimenting with <a href="http://orgmode.org/worg/org-contrib/org-drill.html">org-drill</a> (a spaced repetition extension to <a href="http://orgmode.org/">Org mode</a>).  I
have been using the system (almost) religiously for the past 2 months, and I do
find that it has helped a great deal! (in some respects).  I have also spent a
considerable amount of time trying to reduce the friction to put new stuff into
the system, and am constantly on the look out for further improvements.
</p>

<p>
Using this system has definitely helped with retention, and I find that I can
recall quite a few things I have read a few weeks ago, that I would normally
have been unable to. Though, I can recall a lot of information, I have been
having a feeling of "fragmentation": the feeling of just retaining individual
bits/fragments of information, while losing out on actually internalizing the
knowledge; not seeing the big picture, etc.
</p>

<p>
Wozniak (the author of super-memo) <a href="http://www.supermemo.com/articles/20rules.htm">warns against</a> learning without
understanding, and memorizing before actually learning stuff.  I haven't
consciously added stuff into the system that I didn't understand (when I added
it), but, later it does feel like I have lost some connections or the
understanding, and am only holding onto the fragments of information.
</p>

<p>
The problems as explained in (read: as interpreted by me from) <a href="http://www.amazon.com/Make-Stick-Science-Successful-Learning/dp/0674729013/ref=sr_1_1/188-6768042-2821103?ie=UTF8&amp;qid=1421439099&amp;sr=8-1&amp;keywords=make+it+stick&amp;pebp=1421439103302&amp;peasin=674729013">Make it Stick</a>
appear to be:
</p>

<ol class="org-ol">
<li>The understanding (if any) at the time of adding stuff into the
spaced-repetition system is untested.  It may just be familiarity
masquerading as understanding.
</li>

<li>The lack of any spaced repetitions for the overall concept/understanding and
actual repetitions only for individual bits doesn't help retention of the
understanding (even if there was any, in the first place).
</li>
</ol>
<p>
To work around this, I'm going to try adding questions that test understanding,
to the system.  The Super-memo team strongly recommends keeping the drill items
small and easy to answer.  This may be helpful in keeping each drill session
short, but I would really like to add conceptual questions to the system, and
see how it goes. I hacked <code>org-drill</code> to allow me to type out answers, before
looking at the "correct" ones.  This is an adaptation of a system that a fellow
Hacker Schooler uses, and shared.  Also, hopefully forcing myself to type out
the answer will help me get around the problem of sometimes saying "yeah I know
that", then looking at the answer only to reaffirm the feeling of familiarity,
rather than actually testing myself.  I'm still going to continue adding quick
and short questions that test "bits of information", though. But, hopefully the
additional conceptual questions are going to tie things together and help fill
in the gaps.  Lets see how this goes!
</p>

<p>
For those interested, my hacks to <code>org-drill</code> below.  The code is really a
hack, and welcome any suggestions on cleaning up the code.
</p>

<div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">advice-add</span> <span class="ss">'org-drill-presentation-prompt</span> <span class="nb">:around</span> <span class="ss">'pc/org-drill-presentation-prompt</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">pc/org-drill-presentation-prompt</span> <span class="p">(</span><span class="nv">old-fun</span> <span class="kp">&amp;rest</span> <span class="nv">fmt-and-args</span><span class="p">)</span>
  <span class="s">"A presentation prompt that allows capturing answers."</span>

  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">cb</span> <span class="p">(</span><span class="nf">current-buffer</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">heading</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">4</span> <span class="p">(</span><span class="nv">org-heading-components</span><span class="p">)))</span>
	<span class="p">(</span><span class="nv">entry-id</span> <span class="p">(</span><span class="nv">org-entry-get</span> <span class="p">(</span><span class="nf">point</span><span class="p">)</span> <span class="s">"ID"</span><span class="p">))</span>
	<span class="p">(</span><span class="nv">input</span> <span class="s">""</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">switch-to-buffer-other-window</span> <span class="s">"*org-capture-drill-answer*"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-mode</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">insert</span> <span class="s">"# Hit C-c C-c once you are done answering!\\n"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-insert-heading-respect-content</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">insert</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"Answer: %s"</span> <span class="nv">heading</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">org-entry-put</span> <span class="p">(</span><span class="nf">point</span><span class="p">)</span> <span class="s">"QUESTION_ID"</span> <span class="nv">entry-id</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nf">point-max</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">insert</span> <span class="s">"  "</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-time-stamp-inactive</span> <span class="o">'</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
    <span class="p">(</span><span class="nf">insert</span> <span class="s">"\\n\\n  "</span><span class="p">)</span>
    <span class="p">(</span><span class="k">while</span> <span class="p">(</span><span class="nv">not</span> <span class="p">(</span><span class="k">and</span> <span class="nv">input</span> <span class="p">(</span><span class="nf">equal</span> <span class="nv">input</span> <span class="s">""</span><span class="p">)))</span>
      <span class="p">(</span><span class="nb">ignore-errors</span>
	<span class="p">(</span><span class="nf">execute-kbd-macro</span> <span class="nv">input</span><span class="p">))</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">input</span> <span class="p">(</span><span class="nf">read-key-sequence</span> <span class="no">nil</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">switch-to-buffer-other-window</span> <span class="nv">cb</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">apply</span> <span class="nv">old-fun</span> <span class="nv">fmt-and-args</span><span class="p">)))</span>

<span class="p">(</span><span class="nv">advice-add</span> <span class="ss">'org-drill-reschedule</span> <span class="nb">:around</span> <span class="ss">'pc/org-drill-reschedule</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">pc/org-drill-reschedule</span> <span class="p">(</span><span class="nv">old-fun</span><span class="p">)</span>
  <span class="s">"Calls the original reschedule, but also archives the answer"</span>
  <span class="p">(</span><span class="k">prog1</span> <span class="p">(</span><span class="nf">funcall</span> <span class="nv">old-fun</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">cb</span> <span class="p">(</span><span class="nf">current-buffer</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">switch-to-buffer-other-window</span> <span class="s">"*org-capture-drill-answer*"</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">pc/org-refile-to-datetree</span> <span class="s">"drill.org_archive"</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">message</span> <span class="p">(</span><span class="nf">buffer-name</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">switch-to-buffer-other-window</span> <span class="nv">cb</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">kill-buffer</span> <span class="s">"*org-capture-drill-answer*"</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">require</span> <span class="ss">'org-datetree</span><span class="p">)</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">pc/org-refile-to-datetree</span> <span class="p">(</span><span class="nv">journal</span><span class="p">)</span>
  <span class="s">"Refile an entry to journal file's date-tree"</span>
  <span class="p">(</span><span class="k">interactive</span> <span class="s">"fRefile to: "</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">journal</span> <span class="p">(</span><span class="nf">expand-file-name</span> <span class="nv">journal</span> <span class="nv">org-directory</span><span class="p">))</span>
	 <span class="p">(</span><span class="nv">date-string</span> <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nv">org-entry-get</span> <span class="p">(</span><span class="nf">point</span><span class="p">)</span> <span class="s">"TIMESTAMP_IA"</span><span class="p">)</span>
			  <span class="p">(</span><span class="nv">org-entry-get</span> <span class="p">(</span><span class="nf">point</span><span class="p">)</span> <span class="s">"TIMESTAMP"</span><span class="p">)))</span>
	 <span class="p">(</span><span class="nv">dct</span> <span class="p">(</span><span class="nf">decode-time</span> <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="k">and</span> <span class="nv">date-string</span> <span class="p">(</span><span class="nv">org-time-string-to-time</span> <span class="nv">date-string</span><span class="p">))</span>
			       <span class="p">(</span><span class="nf">current-time</span><span class="p">))))</span>
	 <span class="p">(</span><span class="nv">date</span> <span class="p">(</span><span class="nf">list</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">4</span> <span class="nv">dct</span><span class="p">)</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">3</span> <span class="nv">dct</span><span class="p">)</span> <span class="p">(</span><span class="nf">nth</span> <span class="mi">5</span> <span class="nv">dct</span><span class="p">))))</span>
    <span class="p">(</span><span class="nv">org-cut-subtree</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">with-current-buffer</span> <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nv">find-buffer-visiting</span> <span class="nv">journal</span><span class="p">)</span>
			     <span class="p">(</span><span class="nv">find-file-noselect</span> <span class="nv">journal</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">org-mode</span><span class="p">)</span>
      <span class="p">(</span><span class="k">save-excursion</span>
	<span class="p">(</span><span class="nv">org-datetree-file-entry-under</span> <span class="p">(</span><span class="nv">current-kill</span> <span class="mi">0</span><span class="p">)</span> <span class="nv">date</span><span class="p">)</span>
	<span class="p">(</span><span class="nv">bookmark-set</span> <span class="s">"org-refile-last-stored"</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">message</span> <span class="s">"Refiled to %s"</span> <span class="nv">journal</span><span class="p">)))</span>
</pre></div>
    </div>
    </article>
</div>
        <div class="pagination">
            <span class="pagination-item newer">
                <a href="/tags/blag.html" rel="prev">Newer posts</a>
            </span>
        </div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
          var toggle = document.querySelector('.sidebar-toggle');
          var sidebar = document.querySelector('#sidebar');
          var checkbox = document.querySelector('#sidebar-checkbox');

          // Uncheck checkbox by default on non-wide screens.
          if (window.innerWidth < 1300) {
              checkbox.checked = false;
          }

          // FIXME: The checkbox should have a cookie!
          // http://www.quirksmode.org/js/cookies.html

      })(document);
    </script><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-21111013-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/fuse.js/1.0.0/fuse.min.js"></script><script type="text/javascript" src="/assets/js/tipuesearch_set.js"></script><script type="text/javascript" src="/assets/js/tipuesearch.min.js"></script><script type="text/javascript">
$(document).ready(function() {
    $('#tipue_search_input').tipuesearch({
        'mode': 'json',
        'contentLocation': '/assets/js/tipuesearch_content.json',
        'showUrl': false
    });
});
</script><!-- RC Scout --><div class="rc-scout wrap" title="Want to become a better programmer?"></div>
<script async defer src="https://www.recurse-scout.com/loader.js?t=8b0acf2a60ae4365bee9568bede83f28"></script>
</body>
</html>
